

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Start &mdash; xpdAcq 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="xpdAcq 1.0 documentation" href="index.html"/>
        <link rel="next" title="XPD Users" href="xpdusers.html"/>
        <link rel="prev" title="Beamline Staff Only" href="beamlinestaff.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> xpdAcq
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="beamlinestaff.html">Beamline Staff Only</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#checklist">Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="#collecting-data-quickstart">Collecting Data Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remember">Remember!</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xpdusers.html">XPD Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">xpdAcq</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Quick Start</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/quickstart.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start">
<span id="bls"></span><h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<div class="section" id="checklist">
<h2>Checklist<a class="headerlink" href="#checklist" title="Permalink to this headline">¶</a></h2>
<p>The instrument scientist (IS) should have set up your beamtime hardware and software
for you.  Let&#8217;s check if it is the case.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Activate the xpd data acquisition environment:</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>In a terminal look to see if it is already activated.  If it is, you should see <code class="docutils literal"><span class="pre">(collection)</span></code> at the beginning of the line.</li>
<li>If you don&#8217;t see it, type <code class="docutils literal"><span class="pre">icollection</span></code> at the command prompt then check again.</li>
</ol>
</div></blockquote>
<ol class="arabic simple">
<li>OK, you are in.  Make sure that that the instrument scientist has initiated your beamtime. type <code class="docutils literal"><span class="pre">bt.md</span></code> and hit return. You should see the beamtime (<code class="docutils literal"><span class="pre">bt</span></code>) metadata (<code class="docutils literal"><span class="pre">md</span></code>) that has been pre-stored by the IS, and it should contain things like the last name of the PI on the proposal and the SAF number for the beamtime.  If not, please seek out the IS to get your session initialized.</li>
<li>Check that the wavelength has been set.  Does the correct x-ray wavelength appear in <code class="docutils literal"><span class="pre">bt.md</span></code> <code class="docutils literal"><span class="pre">['bt_wavelength']</span></code> field, or does it say <code class="docutils literal"><span class="pre">None</span></code>.  If the latter, you can still collect scans but automated data reduction may not work, so best to grab the IS again.</li>
<li>Has a calibration already been carried out?  [FIXME]</li>
<li>Check that the Perkin Elmer detector is correctly set up.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Look at the Perkin Elmer screen on the CSS and make sure that it registers <code class="docutils literal"><span class="pre">continuous</span></code> for the acquisition mode.</li>
<li>Type <code class="docutils literal"><span class="pre">glbl.area_det</span></code> and return.  It should return <code class="docutils literal"><span class="pre">'pe1c'</span></code> unless the IS tells you otherwise.</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="4">
<li>There are other setups that you can do to make your experiment run smoothly,  but you seem to be set up ok, so let&#8217;s go and collect some data.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="collecting-data-quickstart">
<h2>Collecting Data Quickstart<a class="headerlink" href="#collecting-data-quickstart" title="Permalink to this headline">¶</a></h2>
<p>The basic way to collect data is to carry out a &#8220;scan&#8221;, by typing the kind of scan and giving it as arguments a <code class="docutils literal"><span class="pre">sample-object</span></code> and a <code class="docutils literal"><span class="pre">scanplan-object</span></code>.  These objects just contain information that will either be used to run the scan, and/or just saved as metadata with the data, allowing you to find the data later and process it. You will make your own objects later, but for now you can do a quick scan just to collect some data with some predefined objects.</p>
<blockquote>
<div><ol class="arabic simple">
<li>Type <code class="docutils literal"><span class="pre">bt.list()</span></code> and return.  You should see a list of objects and their index, or the number they sit in the list.</li>
<li>To run a scan you type <code class="docutils literal"><span class="pre">prun(&lt;sample-object&gt;,&lt;scanplan-object&gt;)</span></code>, replacing those words in angle brackets with pointers to real objects. e.g.,</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">prun(bt.get(2),bt.get(5))</span></code> will do a scan on the dummy sample (<code class="docutils literal"><span class="pre">'sa'</span></code>) called <code class="docutils literal"><span class="pre">'l-user'</span></code>&#8211;(for lazy user!) which is in position (index) <code class="docutils literal"><span class="pre">2</span></code> in the <code class="docutils literal"><span class="pre">bt.list()</span></code> list&#8211;for 1 second (the name of that object in the list at position <code class="docutils literal"><span class="pre">5</span></code> is <code class="docutils literal"><span class="pre">'ct1s'</span></code> which stands for &#8220;count 1 second&#8221;).</li>
<li><code class="docutils literal"><span class="pre">prun(bt.get(2),bt.get(7))</span></code> will do a scan for 10 s on the same sample.</li>
<li><code class="docutils literal"><span class="pre">setupscan(bt.get(2),bt.get(7))</span></code> will do a setupscan on that sample for 10 seconds.  A setupscan is like a prun (&#8220;production run&#8221;) except it is tagged in metadata as a setupscan so you can separate later which were production runs and which were setup-scans.</li>
</ol>
</div></blockquote>
<ol class="arabic simple" start="3">
<li>to see the data you have to extract it from the NSLS-ii database.</li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li>Type <code class="docutils literal"><span class="pre">save_last_tiff()</span></code> to get the most recent scan you ran.  A dark-subtracted tiff file will appear in the directory <code class="docutils literal"><span class="pre">~/xpdUser/tiff_base</span></code>.</li>
<li><code class="docutils literal"><span class="pre">save_tiff(db[-2])</span></code> gets you the second to last scan that was collected, <code class="docutils literal"><span class="pre">save_tiff(db[-10:])</span></code> gets you the last 10 scans, (the syntax is Pythonic but it means &#8220;the items in the list from 10 ago up to the end of the list, i.e., now&#8221;.  You can do all kinds of slicing and dicing, for example <code class="docutils literal"><span class="pre">db[-10:-8,-2]</span></code> would return the scans that were tenth, ninth and eigth ago, and also the last but one.) and so on.</li>
<li>The tiff file appears in the directory <code class="docutils literal"><span class="pre">~/xpdUser/tiff_base</span></code> with a reasonably recognizable automatically generated name and you can do pretty much what you like with it. For example, copy it to an external drive.  However, there are handy tools on the xpd computer for analyzing your data.  As long as you save all your work in the <code class="docutils literal"><span class="pre">xpdUser</span></code> directory tree (make as many directories as you like under there) your work will be archived in a remote location at the end of your beamtime, and then completely deleted from the local XPD computer so that the next user has their own fresh environment to work in but your work is safe.</li>
<li>To use data analysis tools on the XPD computer, in a new terminal window,</li>
</ol>
<blockquote>
<div>1. type <code class="docutils literal"><span class="pre">xpdfsuite</span></code> [FIXME, I don&#8217;t know how to start xpdfsuite on the xpd computer].
2 Click on the green <code class="docutils literal"><span class="pre">SrXplanar</span></code> icon [Soham or someone, can you put instructions here for using <code class="docutils literal"><span class="pre">SrXplanar</span></code>]</div></blockquote>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="remember">
<h2>Remember!<a class="headerlink" href="#remember" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">bt.list()</span></code> to see what objects are available</li>
<li><code class="docutils literal"><span class="pre">prun(bt.get(&lt;sampleIndex&gt;)bt.get(&lt;scanIndex&gt;))</span></code> to run the scan</li>
<li><code class="docutils literal"><span class="pre">save_tiff(db[list_of_scans])</span></code> to get the data back as a tiff file</li>
<li><code class="docutils literal"><span class="pre">xPDFsuite</span></code> to visualize it, integrate it to 1D and process to get a diffraction pattern or PDF.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="next-steps">
<h2>Next Steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h2>
<p>So you have collected some data, and looked at it.  It is probably time to set up some more extensive data-objects so that you will be able to search easily for your data later and do more sophisticated scans.  Please take the time to read the full documentation from :ref: <cite>xpdu</cite> onwards to get the most out of your data.  But for now, here is a quick summary.</p>
<dl class="docutils">
<dt>Types of scan available.  They all take as arguments <code class="docutils literal"><span class="pre">&lt;sample-object&gt;,&lt;scanplan-object&gt;</span></code> in that order.:</dt>
<dd><ol class="first last arabic simple">
<li><code class="docutils literal"><span class="pre">prun()</span></code> - the one you will use the most.  It stands for &#8220;production run&#8221;</li>
<li><code class="docutils literal"><span class="pre">setupscan()</span></code> - it is just the same as <code class="docutils literal"><span class="pre">prun()</span></code> but the data are tagged as being test/setup data, helping you to keep track of what is what later.</li>
<li><code class="docutils literal"><span class="pre">dryrun()</span></code> - does a kind of dummy scan but doesn&#8217;t execute anything</li>
<li><code class="docutils literal"><span class="pre">dark()</span></code> - collects a dark scan (shutter closed).  The default behavior is that darks are collected automatically and linked to lights so if all is going well you should never have to use this, but in case you do it is there.</li>
<li><code class="docutils literal"><span class="pre">background()</span></code> - [not implemented yet].  Like <code class="docutils literal"><span class="pre">prun()</span></code> but it tags the dataset as a background scan for that sample and scanplan configuration</li>
</ol>
</dd>
<dt>You should try and set up some of your own scanplan objects:</dt>
<dd><ol class="first arabic simple">
<li>let&#8217;s say you want to do a count scan for 1.5 minutes.</li>
</ol>
<blockquote class="last">
<div><ol class="arabic simple">
<li>type <code class="docutils literal"><span class="pre">bt.list('sc')</span></code>  to see the current list of scan objects</li>
<li>type <code class="docutils literal"><span class="pre">ScanPlan('&lt;scan</span> <span class="pre">name&gt;','ct',{'exposure':90})</span></code>.  This creates a <code class="docutils literal"><span class="pre">'ct'</span></code> or count-type scan with an exposure of 90 s or 1.5 minutes, calling it whatever you typed for <code class="docutils literal"><span class="pre">&lt;scan</span> <span class="pre">name&gt;</span></code>.  Pro tip: use <code class="docutils literal"><span class="pre">'ct90s'</span></code> or <code class="docutils literal"><span class="pre">'ct1.5m'</span></code> for the scan name.</li>
<li>type <code class="docutils literal"><span class="pre">bt.list()</span></code> again.  You should see your new scanplan object at the end of the list.  Run it using <code class="docutils literal"><span class="pre">prun(bt.get(2),bt.get(11))</span></code> or giving a different number to the second <code class="docutils literal"><span class="pre">get</span></code> if it has a different number in the list.</li>
</ol>
</div></blockquote>
</dd>
<dt>Types of ScanPlan available:</dt>
<dd><ol class="first last arabic simple">
<li><code class="docutils literal"><span class="pre">'ct'</span></code> just exposes the the detector for a number of seconds. e.g.,  <code class="docutils literal"><span class="pre">ScanPlan('ct17.5s','ct',{'exposure':17.5})</span></code></li>
<li><code class="docutils literal"><span class="pre">'tseries'</span></code> executes a series of <code class="docutils literal"><span class="pre">'num'</span></code> counts of exposure time <code class="docutils literal"><span class="pre">'exposure'</span></code> seconds with  a delay of <code class="docutils literal"><span class="pre">'delay'</span></code> seconds between them.  e.g., <code class="docutils literal"><span class="pre">ScanPlan('t50_e1s_d59s','tseries',{'num':50,'exposure':1,'delay':59})</span></code> will measure 50 scans of 1 second with a delay of 59 seconds in between each of them.</li>
<li><code class="docutils literal"><span class="pre">'Tramp'</span></code> executes a temperature ramp from <code class="docutils literal"><span class="pre">'startingT'</span></code> to <code class="docutils literal"><span class="pre">'endingT'</span></code> in temperature steps of <code class="docutils literal"><span class="pre">'Tstep'</span></code> with exposure time of <code class="docutils literal"><span class="pre">'exposure'</span></code>.  e.g., <code class="docutils literal"><span class="pre">ScanPlan('T200K_500K_5K_1s','Tramp',{'startingT':200,</span> <span class="pre">'endingT':500,</span> <span class="pre">'Tstep':5,</span> <span class="pre">'exposure':1})</span></code> will automatically change the temperature, starting at 200 K and ending at 500 K, measuring a scan of 1 s at every 5 K step.  The temperature controller will hold at each temperature until the temperature stabilizes before starting the measurement.</li>
</ol>
</dd>
<dt>Experiment and sample objects:</dt>
<dd><ol class="first last arabic simple">
<li>The tiff file will be saved with the name <code class="docutils literal"><span class="pre">&lt;sample-name&gt;_&lt;scan-name&gt;_&lt;time-stamp&gt;_&lt;something-else&gt;.tiff</span></code>, and all the information in the scan and sample objects will be saved to metadata and searchable and usable for processing later.  The &lt;something-else&gt; depends on the scan type, for example, for a <code class="docutils literal"><span class="pre">Tramp</span></code> it is the actual temperature read from the temperature controller when the data-collection was initiated for that point.  It is time well spent to set up all your experimnet and sample objects accurately. [not implemented yet] It is possible to download xpdAcq and run it on your own computer to set up the sample and scan objects you think you will need at the beamtime, so when you are at XPD you can concentrate on collecting data and not typing metadata.  It is strongly recommended.  See the full documentation for more details.</li>
<li>To set up a sample you have to give it an experiment object, so <code class="docutils literal"><span class="pre">Sample('Li</span> <span class="pre">battery</span> <span class="pre">electrode',bt.get(96))</span></code> uses the object in <code class="docutils literal"><span class="pre">bt.list(96)</span></code> which must be an <code class="docutils literal"><span class="pre">ex</span></code> type object, for example I may have made it with <code class="docutils literal"><span class="pre">Experiment('cycled</span> <span class="pre">and</span> <span class="pre">uncycled</span> <span class="pre">batteries',bt)</span></code>.  The <code class="docutils literal"><span class="pre">bt</span></code> is the beamtime object.  For more info on why it is set up this way, see the docs!</li>
</ol>
</dd>
<dt>User scripts:</dt>
<dd>Your scans can be sequenced into scripts, executing one after the other as you desire.  To set this up, write a sequence of commands into a text file, save it with the extension <code class="docutils literal"><span class="pre">.py</span></code> in the <code class="docutils literal"><span class="pre">userScripts</span></code> directory with a memorable name, like <code class="docutils literal"><span class="pre">myNightShiftScript.py</span></code>. Double and triple check it, then when you are ready to execute it, type <code class="docutils literal"><span class="pre">!run</span> <span class="pre">~/userScripts/myNightShiftScript.py</span></code>, make sure it is running as expected, and go to bed!</dd>
</dl>
<p>There is much more to the xpdAcq software that will give you superpowers in rapid and flexible data collection, data retrieval and processing.  This was just the quick start, but much more information is in the full documentation.</p>
<p>Move on <a class="reference internal" href="xpdusers.html#xpdu"><span>XPD Users</span></a></p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="xpdusers.html" class="btn btn-neutral float-right" title="XPD Users" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="beamlinestaff.html" class="btn btn-neutral" title="Beamline Staff Only" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright (c) 2016 trustees of Columbia University in the City of New York.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>